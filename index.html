<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleared Deposit Status Update Form</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <img src="https://github.com/skyber-tech/cleared-deposit-form/blob/main/Logo.png?raw=true" alt="Logo" class="logo">
        </aside>
        
        <!-- Main Content -->
        <div class="main-content">
            <form id="depositForm">
                <h2>Cleared Deposit Status Update</h2>
                
                <!-- Original form fields with conditional entity fields -->
                <div class="form-group">
                    <label for="entity">Entity Source</label>
                    <select id="entity" name="entity" required>
                        <option value="">Select Entity</option>
                        <option value="OGC">OGC</option>
                        <option value="HNI">HNI</option>
                        <option value="JIB">JIB</option>
                        <option value="MSCS">MSCS</option>
                        <option value="Oleevia Foundation">Oleevia Foundation</option>
                        <option value="OWN Restaurant">OWN Restaurant</option>
                    </select>
                </div>

                <div id="ogcFields" style="display:none;">
                    <div class="form-group">
                        <label for="state">State Name</label>
                        <input type="text" id="state" name="state">
                    </div>
                    <div class="form-group">
                        <label for="stateHead">State Head (With Employee Code)</label>
                        <input type="text" id="stateHead" name="stateHead">
                    </div>
                    <div class="form-group">
                        <label for="region">Region Name</label>
                        <input type="text" id="region" name="region">
                    </div>
                    <div class="form-group">
                        <label for="regionHead">Region Head (With Employee Code)</label>
                        <input type="text" id="regionHead" name="regionHead">
                    </div>
                    <div class="form-group">
                        <label for="cluster">Cluster Name</label>
                        <input type="text" id="cluster" name="cluster">
                    </div>
                    <div class="form-group">
                        <label for="clusterHead">Cluster Head (With Employee Code)</label>
                        <input type="text" id="clusterHead" name="clusterHead">
                    </div>
                    <div class="form-group">
                        <label for="branch">Branch Name</label>
                        <input type="text" id="branch" name="branch">
                    </div>
                </div>

                <div class="form-group">
                    <label for="employeeID">Canvassed Person ID</label>
                    <input type="text" id="employeeID" name="employeeID" placeholder="Enter Employee ID" onblur="fetchEmployeeName()">
                </div>

                <div class="form-group">
                    <label for="employeeName">Canvassed Person Name</label>
                    <input type="text" id="employeeName" name="employeeName" readonly>
                </div>

                <div class="form-group">
                    <label for="customerName">Customer Name</label>
                    <input type="text" id="customerName" name="customerName" required>
                </div>

                <div class="form-group">
                    <label for="customerContact">Customer Contact Details</label>
                    <input type="text" id="customerContact" name="customerContact" required>
                </div>

                <div class="form-group">
                    <label for="productSourced">Product Sourced</label>
                    <select id="productSourced" name="productSourced" required>
                        <option value="">Select Product</option>
                        <option value="NCD">NCD</option>
                        <option value="CCD">CCD</option>
                        <option value="SD">SD</option>
                        <option value="Membership">Membership</option>
                        <option value="Insurance">Insurance</option>
                        <option value="RD">RD</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="payoutFrequency">Payout Frequency</label>
                    <select id="payoutFrequency" name="payoutFrequency" required>
                        <option value="Monthly">Monthly</option>
                        <option value="Quarterly">Quarterly</option>
                        <option value="Half-yearly">Half-yearly</option>
                        <option value="Annually">Annually</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="amount">Amount</label>
                    <input type="number" id="amount" name="amount" required>
                </div>

                <div class="form-group">
                    <label>Mode of Transaction</label>
                    <label class="bubbly-checkbox">
                        <input type="radio" id="cheque" name="transactionMode" value="Cheque" required>
                        <span>Cheque</span>
                    </label>
                    <label class="bubbly-checkbox">
                        <input type="radio" id="online" name="transactionMode" value="Online" required>
                        <span>Online</span>
                    </label>
                </div>

                <div class="form-group">
                    <label>Application Type</label>
                    <label class="bubbly-checkbox">
                        <input type="radio" id="fresh" name="applicationType" value="Fresh" required>
                        <span>Fresh</span>
                    </label>
                    <label class="bubbly-checkbox">
                        <input type="radio" id="renewal" name="applicationType" value="Renewal" required>
                        <span>Renewal</span>
                    </label>
                </div>

                <div class="form-group consent">
                    <label class="bubbly-checkbox">
                        <input type="checkbox" id="confirmation" name="confirmation" required>
                        <span>I confirm that all information entered is accurate to the best of my knowledge.</span>
                    </label>
                </div>

                <button type="submit" class="submit-btn">Save & Continue</button>
            </form>
        </div>
    </div>

    <!-- Success Popup -->
    <div id="successPopup" class="popup" style="display: none;">
        <div class="popup-content">
            <div class="checkmark">
                &#10004;
            </div>
            <p>Form submitted successfully!</p>
            <button onclick="closePopup()">Close</button>
        </div>
    </div>

    <!-- JavaScript for AJAX submission and popup -->
    <script>
        document.getElementById("depositForm").addEventListener("submit", function(event) {
            event.preventDefault();
            const formData = new FormData(document.getElementById("depositForm"));
            fetch("https://script.google.com/macros/s/AKfycbxFhwf2QAIpVvaUj_5oKtNafE_BbYrYo7WIZ71-EwKgTIKahfmAe3gSwkmrJuxVln0D/exec", {
                method: "POST",
                body: formData
            })
            .then(response => response.text())
            .then(() => {
                document.getElementById("successPopup").style.display = "flex";
            })
            .catch(error => console.error("Error:", error));
        });

        function closePopup() {
            document.getElementById("successPopup").style.display = "none";
            document.getElementById("depositForm").reset();
        }

        document.getElementById("entity").addEventListener("change", function() {
            document.getElementById("ogcFields").style.display = this.value === "OGC" ? "block" : "none";
        });

        const employeeData = {
            "OGC001": "RAMESH CR",
            "OLV001": "ANEESH K A",
            "OLV002": "TITO PAUL T",
            "OLV003": "JEESON P J",
            "OGC002": "VISHNUPRIYA P R"
        };

        function fetchEmployeeName() {
            const employeeID = document.getElementById("employeeID").value;
            const employeeName = employeeData[employeeID];
            document.getElementById("employeeName").value = employeeName || "Employee not found";
        }
    </script>
</body>
</html>
